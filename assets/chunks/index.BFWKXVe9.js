import{d as z,p as f,h,aq as G,c as g,o as c,G as R,w as v,F as J,B as T,a0 as k,n as d,k as m,j as b,e as w,ao as W,au as X,b as y,H as S}from"./framework.Dg_YdSV9.js";import{g as Y,f as Z}from"./index.DDCPcHk4.js";import{_ as ee}from"./index.DPhsdcmJ.js";import{R as le}from"./RenderVnode.DBxJ6fEB.js";import{_ as F}from"./index.Cs7zQyVH.js";import{i as te,c as N}from"./isFunction.CCVhMlqu.js";const oe={class:d(["selected-item","input-wrapper"])},ne=["readonly","placeholder","disabled"];const ae={class:"suffix"},se={key:0,class:"open-select__nodata"},ie={key:1,class:"open-select__menu"},ce=["onClick"],x=z({name:"OpenSelect",__name:"select",props:{name:{},id:{},modelValue:{},disabled:{type:Boolean,default:!1},effect:{},options:{default:()=>[]},clearable:{type:Boolean},filterable:{type:Boolean,default:!1},loading:{type:Boolean},placeholder:{},suffixIcon:{default:Z},remote:{type:Boolean},clearIcon:{default:Y},filterMethod:{},remoteMethod:{},multiple:{type:Boolean},placement:{default:"bottom-start"},trigger:{default:"click"}},emits:["update:modelValue","visible-change","input","change","focus","blur","keydown","clear"],setup(o,{emit:E}){const t=o,I=f(!1),r=E,Q=(e=>t.options.find(s=>s.value===e)||null)(t.modelValue),a=f(t.options),p=h(()=>t.disabled),l=G({inputValue:"",selectedOption:Q,mouseHover:!1,loading:!1,highlightIndex:-1,previousQuery:null,selectedLabel:""}),V=f(null),n=f(!1),_=f(),ue=h(()=>{const e=t.placeholder??"please select";return t.multiple?e:l.selectedLabel});h(()=>te(t.modelValue)?t.modelValue.length===0&&!l.inputValue:t.filterable?!l.inputValue:!0);const B=h(()=>t.clearable&&!p.value&&l.inputValue),u=e=>{e?(console.log(`${n.value}@@`),_.value.show()):(_.value.hide(),console.log(`visible-change${n.value}`),r("visible-change",e)),n.value=e},C=e=>{var i;e.disabled||(l.inputValue=e.label,l.selectedOption=e,r("change",e.value),r("update:modelValue",e.value),console.log("执行了"),u(!1),console.log("执行完了"),(i=V.value)==null||i.focus())},A=e=>{switch(console.log(`KeyboardEvent@@@@@${e.key}`),e.key){case"Enter":n.value?l.highlightIndex>0&&a.value[l.highlightIndex]?C(a.value[l.highlightIndex]):u(!1):u(!0);break;case"Escape":n.value&&u(!1);break;case"ArrowUp":e.preventDefault(),a.value.length>0&&(l.highlightIndex===-1||l.highlightIndex===0?l.highlightIndex=a.value.length-1:l.highlightIndex--);break;case"ArrowDown":e.preventDefault(),a.value.length>0&&(l.highlightIndex===-1||l.highlightIndex===a.value.length-1?l.highlightIndex=0:l.highlightIndex++);break}},D=()=>{p.value||(n.value?(console.log(`isDropdownShow1${n.value}`),u(!1)):(console.log(`isDropdownShow2${n.value}`),u(!0)))},O=h(()=>t.suffixIcon),K=()=>{l.selectedOption=null,l.inputValue="",r("clear"),r("change",""),r("update:modelValue","")},L=e=>{l.previousQuery!==e&&(l.previousQuery=e,t.filterable&&N(t.filterMethod)?a.value=t.filterMethod(e):t.filterable&&t.remote&&N(t.remoteMethod)?t.remoteMethod(e):a.value=t.options.filter(i=>i.label.includes(e)))},q=()=>{l.inputValue.length>0&&!n.value&&(n.value=!0),L(l.inputValue)},H=({target:e})=>(console.log(`select: ${e.value}`),l.inputValue=e.value,q()),P=e=>{I.value=!0,r("focus",e)},U=e=>{console.log("blur triggered"),I.value=!1,r("blur",e)},j={modifiers:[{name:"offset",options:{offset:[0,9]}},{name:"sameWidth",enabled:!0,phase:"main",fn:({state:e,instance:i,options:s,name:$})=>{e.styles.popper.width=`${e.rects.reference.width}px`,console.log(JSON.stringify(e.styles.popper))},requires:["computeStyles"]}]};return(e,i)=>(c(),g("div",{class:"open-select",ref:"selectRef",onClick:D},[R(m(ee),{ref_key:"tooltipRef",ref:_,placement:o.placement,effect:o.effect,trigger:o.trigger,"popper-options":j},{default:v(()=>[b("div",{class:d(["open-select-wrapper",{"is-disabled":o.disabled}])},[b("div",oe,[W(b("input",{readonly:!o.filterable,placeholder:o.placeholder,ref_key:"inputRef",ref:V,"onUpdate:modelValue":i[0]||(i[0]=s=>l.inputValue=s),type:"text",disabled:p.value,class:d(["open-select__input",{disabled:p.value}]),onFocus:P,onBlur:U,onInput:H,onClick:k(D,["stop"]),onKeydown:A},null,42,ne),[[X,l.inputValue]])]),w("",!0),b("div",ae,[O.value&&!B.value?(c(),y(m(F),{key:0,class:d(["caret","icon",{"is-reverse":n.value,disabled:p.value}])},{default:v(()=>[(c(),y(S(O.value)))]),_:1},8,["class"])):w("",!0),B.value&&o.clearIcon?(c(),y(m(F),{key:1,class:d(["caret","icon"]),onClick:k(K,["stop"])},{default:v(()=>[(c(),y(S(o.clearIcon)))]),_:1})):w("",!0)])],2)]),content:v(()=>[a.value.length===0?(c(),g("div",se,"No match data")):(c(),g("ul",ie,[(c(!0),g(J,null,T(a.value,(s,$)=>{var M;return c(),g("li",{key:s.value,class:d(["open-select__menu-item",{"is-disabled":s.disabled,"is-selected":((M=l.selectedOption)==null?void 0:M.value)===s.value,"is-highlighted":l.highlightIndex===$}]),onClick:k(de=>C(s),["stop"])},[R(m(le),{"v-node":s.label},null,8,["v-node"])],10,ce)}),128))]))]),_:1},8,["placement","effect","trigger"])],512))}});x.install=o=>{o.component(x.name,x)};export{x as _};
